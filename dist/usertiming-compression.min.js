!function(e){"use strict";var r,n;"undefined"!=typeof e?(r=e,n=r.UserTimingCompression):r={};var t,i=t={};i.noConflict=function(){return r.UserTimingCompression=n,i},i.trimTiming=function(e,r){"number"!=typeof e&&(e=0),"number"!=typeof r&&(r=0);var n=Math.round(e),t=Math.round(r);return 0===n?0:n-t},i.toBase36=function(e){return"number"==typeof e?e.toString(36):""},i.findUserTimingForFrame=function(e){var r;if(!e)return[];try{e.location&&e.location.href;if(!("performance"in e&&e.performance&&e.performance.getEntriesByType))return r;r=e.performance.getEntriesByType("mark"),r=r.concat(e.performance.getEntriesByType("measure"))}catch(n){return r}return r},i.compressUserTiming=function(e,r){var n,i,o,a=0,f={};if(r=r||{},!e||!e.length)return[];for(n=0;n<e.length;n++)i=e[n],"undefined"==typeof f[i.name]&&(f[i.name]=[]),"mark"===i.entryType?f[i.name].push({startTime:i.startTime}):"measure"===i.entryType&&f[i.name].push({startTime:i.startTime,duration:i.duration});for(var u in f)if(f.hasOwnProperty(u)){if(r.map&&"undefined"==typeof r.map[u])continue;var s=f[u];for(r.map&&"undefined"!=typeof r.map[u]&&(delete f[u],u=r.map[u]),a=0,n=0;n<s.length;n++){var p=s[n];o=t.toBase36(t.trimTiming(p.startTime,a)),"0"===o&&(o="");var m=o;if("undefined"!=typeof p.duration){var c=t.toBase36(p.duration);m+="_","0"!==c&&(m+=c)}a=p.startTime,s[n]=m}f[u]=t.compressArray(s)}return f},i.convertToTrie=function(e){var r,n,t,i,o,a,f,u={};if(!e)return{};for(r in e)if(e.hasOwnProperty(r))for(t=e[r],i=r.split(""),a=u,n=0;n<i.length;n++)o=i[n],f=a[o],"undefined"==typeof f?a=a[o]=n===i.length-1?t:{}:"string"==typeof f?a=a[o]={"!":f}:n===i.length-1?a[o]["!"]=t:a=a[o];return u},i.optimizeTrie=function(e,r){var n,t,i,o=0;if(!e)return{};for(n in e)"object"==typeof e[n]&&(t=this.optimizeTrie(e[n],!1),t&&(delete e[n],n+=t.name,e[n]=t.value)),o++;return 1===o?r?(i={},i[n]=e[n],i):{name:n,value:e[n]}:!!r&&e},i.compressArray=function(e){var r=0,n="";if(!e||0===e.length||e.constructor!==Array)return"";for(var t=0;t<e.length;t++){var i=e[t];t<e.length-1&&i===e[t+1]?r++:r>0?(n+=(""!==n?".":"")+i+"*",r>=2&&(n+=r+1),r=0):n+=(""!==n?".":"")+i}return/^\d+$/.test(n)?parseInt(n,10):n},i.getCompressedUserTiming=function(r){var n,i;return r=r||{},n=r.window||e,i=this.findUserTimingForFrame(n),r.from&&(i=i.filter(function(e){return e.startTime+e.duration>=r.from})),r.to&&(i=i.filter(function(e){return e.startTime<=r.to})),t.compressUserTiming(i,r)},i.compressForUri=function(e){if("object"!=typeof e)return"";var r=!1;for(var n in e)if(e.hasOwnProperty(n)){if(isNaN(n)){r=!1;break}r=!0}if(r)return"1"+t.flattenMap(e);var i=t.convertToTrie(e),o=t.optimizeTrie(i,!0),a=t.jsUrl(o),f=t.flattenArray(e);if("string"!=typeof f||0===f.length)return"";var u=encodeURIComponent(a),s=encodeURIComponent(f);return u.length<s.length?a:"0"+f},i.flattenArray=function(e){var r=[];if("object"!=typeof e)return"";for(var n in e)if(e.hasOwnProperty(n)){var t=(e[n]+"").replace("~","%7E");n=n.replace("~","%7E"),r.push(n+"~"+t)}return r=r.join("~")},i.flattenMap=function(e){var r=[];if("object"!=typeof e)return"";for(var n in e)if(e.hasOwnProperty(n)){var i=parseInt(n,10),o=t.toBase36(i);if(i>1331)continue;o.length>1&&(o=t.toBase36(i-36),o="-"+(1===o.length?"0":"")+o),r.push(o+e[n])}return r.sort(),r=r.join("~")},i.jsUrl=function(e){function r(e){return/[^\w-.]/.test(e)?e=e.replace(/[^\w-.]/g,function(e){return"$"===e?"!":(e=e.charCodeAt(0),e<256?"*"+("00"+e.toString(16)).slice(-2):"**"+("0000"+e.toString(16)).slice(-4))}):e}switch(typeof e){case"number":return isFinite(e)?"~"+e:"~null";case"string":return"~'"+r(e);case"boolean":return"~"+e;case"object":return e?Array.isArray(e)?"~("+(e.map(function(e){return t.jsUrl(e)||"~null"}).join("")||"~")+")":"~("+Object.keys(e).map(function(n){var i=t.jsUrl(e[n]);return i&&r(n)+i}).filter(function(e){return e}).sort().join("~")+")":"~null";default:return}},"function"==typeof define&&define.amd?define([],function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:"undefined"!=typeof r&&(r.UserTimingCompression=i)}("undefined"!=typeof window?window:void 0);